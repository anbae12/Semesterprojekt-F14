\section{Kravspecifikation}
\label{sec:kravspecifikation}
Kravene til systemet findes vha. reglerne for English Skeet \citep{ES_regler}.
%samt det udleverede systems fysiske begrænsninger.

Lerduens bane beregnes vha. de i reglerne givne værdier for affyringspunkt (D), forventet nedslagspunkt (G)
og "target crossing point" (TCS).
%Med antagelsen om negligerbar luftmodstand kan en kasteparabel således udregnes ved interpolation af disse tre punkter.
Lerduens parabel findes ved interpolation af disse tre punkter. Det antages at luftmodstanden er negligerbar.
%Kasteparablen er givet ved ligning \ref{eq:ks:vektorparabel3d}, med origo som angivet på figur \ref{fig:ES}.
%\begin{equation}
%Pos\left( t \right) = 
%\left( \begin{matrix} 
%	x\left( t \right)  \\ 
%	y\left( t \right)  \\ 
%	z\left( t \right)  \end{matrix} \right) =
%	 \left( \begin{matrix} 
%	- 9,34\cdot t+5,5 \\
%  32,851\cdot t-19,3 \\ 
% -{ 4,91\cdot t }^{ 2 }+5,473\cdot t+3,05\end{matrix} \right) [\text{m}]
%\label{eq:ks:vektorparabel3d}
%\end{equation}

%Med kasteparablen er det muligt at specificere systemets betingelser yderligere:
%Lerduens affyringshastighed og vinkel ift. xy planet kan lerduens flugt beregnes. 
%
Lerduens affyringshastighed og vinkel ift. xy planet blev beregnet vha. den fundne kasteparabel. 
Lerduen affyres med en hastighed på 34,589 \([\frac{m}{s}]\) i en vinkel på \(9,103 \degree\) 
ift. xy-planet jf. figur \ref{fig:ES}\footnote{Beregningerne bag kasteparablen findes i appendix \ref{sec:udregning_af_parabel}.}. 

Lerduens flugt er givet i ligning \ref{eq:ks:vektorparabel3d} med origo som angivet på figur \ref{fig:ES}. 

\begin{equation}
Pos\left( t \right) = 
\left( \begin{matrix} 
	x\left( t \right)  \\ 
	y\left( t \right)  \\ 
	z\left( t \right)  \end{matrix} \right) =
	 \left( \begin{matrix} 
	- 9,34\cdot t+5,5 \\
  32,851\cdot t-19,3 \\ 
 -{ 4,91\cdot t }^{ 2 }+5,473\cdot t+3,05\end{matrix} \right) [\text{m}]
\label{eq:ks:vektorparabel3d}
\end{equation}
%En gennemgang af beregningerne der ligger bag kasteparablen findes i appendix \ref{sec:udregning_af_parabel}.

Lerduens flugt er illustreret på figur \ref{fig:para_total}.
Punktet D er "high house".
Punktet SB og punktet G er hhv. 40,3 [m] og 52 [m] fra "high house". \\
\begin{figure}[h!]
\centering
\subfloat[Lerduens højde som funktion af afstanden til D.\label{fig:HH2D_para}]{%
	\begin{tikzpicture}[scale=0.8]
	\include*{./graphics/high_house_2D_parabola}
	\end{tikzpicture}
}
\subfloat[Lerduens bane projekteret på xy-planet.\label{fig:para_in_xy_plane}]{%
	\begin{tikzpicture}[scale=0.16]
	\include*{./graphics/parabola_in_xy_plane}
	\end{tikzpicture}
}
\caption[Lerduens parabel i 2D]{Viser parablen som udgør lerduens bane i 2D.}
\label{fig:para_total}
\end{figure}

Tilt-rammen kan bevæge sig frit,
men pan-rammen kan pga. en stopklods kun rotere \(154 \degree\)\footnote{Målt eksperimentielt.}.

Haglene fra et 12 gauge haglgevær med Skeet Choke spredes så de dækker et område
%med en diameter på 1,32 [m] på en afstand til centrum af cirklen på 37 [m] 
med en diameter på 1,32 [m] på 37 meters afstand
\citep[Pattern and choke]{patternandchoke}.
Spredningsvinklen er, med en antagelse om lineær spredning, givet ved ligning \ref{eq:ks:spredning}.
\begin{align}
\begin{split}
  Spredning &= 2\cdot{}\tan^{-1}\left(\frac{1,32/2}{37}\right) \\
  &= 2,04 \degree
  \end{split}
  \label{eq:ks:spredning}
\end{align}
%Der er altså et krav om at geværet peger på lerduen med en præcision på \(\pm 1,02 \degree\).
Når tracking fejlen defineres ud fra pan-vinklen \(\theta\) og tilt-vinklen \(\phi\) som i ligning \ref{eq:ks:trackingerror} rammes 
lerduen ved afskydning af haglgeværet når ligning \ref{eq:trackingerrorkrav} opfyldes.
\begin{align}
  TE = \left | \begin{pmatrix}  \theta_{\text{target}}\\ \phi_{\text{target}}\end{pmatrix} - \begin{pmatrix} \theta_{current}\\ 
  \phi_{current}\end{pmatrix} \right | &&\text{(Tracking fejl)}
\label{eq:ks:trackingerror}
\\
	TE\leq 1,02 \degree && \text{(Lerduen rammes)}
\label{eq:trackingerrorkrav}
\end{align}

Settling Time defineres som tiden der går før tracking fejlen forbliver \(\leq 1.02 \degree\).
%som skrevet i ligning \ref{eq:ks:settlingtime}.
%\begin{align}
%{ { t }_{ s }\quad =\left t \right|  }_{ TE\leq 1,02 \degree }
%\label{eq:ks:settlingtime}
%\end{align}

Der affyres mellem det tidspunkt lerduen når toppunktet og SB.
I dette tidsrum skal PTS sigte præcist på lerduen under opfyldelse af ligning \ref{eq:trackingerrorkrav} og dette 
stiller krav til Settling Time, \(t_s\), som skrevet i ligning \ref{eq:ks:settlingtime1}.
%Tidspunktet, hvor lerduen når sit toppunkt er altså samtidigt tid er altså det højeste settling time må være, ligning \ref{eq:ks:settlingtime1}

\begin{align}
  t_{top} &= 0,557\text{ [s]} &\text{(Toppunktet af parablen)}
  \label{eq:ks:toppunktstid}
  \\
   t_{SB} &= 1,18\text{ [s]} &\text{(SB)}
  \label{eq:ks:toppunktstid}
  \\
  t_{s} & \leq 0,557\text{ [s]} &\text{(Krav til Settling Time)}
  \label{eq:ks:settlingtime1}
\end{align}

%I dette tidsrum skal Pan \& Tilt-systemet sigte præcist på lerduen og kravet til 
%tracking error i ligning \ref{eq:ks:trackingerrorsize} skal overholdes.
%Der er altså et tidsmæssigt krav til reguleringen om en indsvingningstid (Settling Time) for systemet,
%der er lavere end tiden \(t_{s}\) angivet i ligning, \ref{eq:ks:settlingtime}.
%Dette krav gælder for både pan-rammens vinkel (\(\phi\)) og tilt-rammens vinkel (\(\theta\)).
%For en 1-radian reference giver dette altså en maksimal tracking error (SSE) på 1,78 \%.
%\todo[inline, author=Michael]{Den virkelige sammenhænge er mere kompleks: Hvis både pan \& tilt rammen peger 1\degree ved siden af, er den samlede afvigelse vel over 1,02\degree}
%\todo[inline, color = pink, author = Mikkel]{Hvad mening giver det at kigge på 1 radian reference og kan man virkelig kalde det SSE?}
Det eneste krav der stilles til systemet er altså et Settling Time krav.

%Dette giver altså en øvre og en nedre grænse for pan-rammens maksimale udsving,
%som afhænger af reguleringen
%- et for højt overshoot på pan-positionen kan give udsving, der ikke holder sig inden for grænserne.
%Hvis det antages, at vinklen \(0 \degree\) er lige midt imellem pan-rammens rotationsgrænser,
%så den kan rotere \(77 \degree\) til hver side, så er det maksimale overshoot for et 1-radians step-input
%givet ved \(34 \%\).
%\todo[inline, color = pink, author = Mikkel]{Hvad mening giver den 1 radian reference?}
%\todo[inline, author=Michael]{Indsæt evt. figur med overshoot begrænsninger?}


